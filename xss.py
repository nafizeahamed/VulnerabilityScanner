import scanner
login_url=""
vuln_scan = ""

def xss_in_link(url):
    xss_test_script = "<sCript>alert(1)</scriPt>"
    response = vuln_scan.session.get(url)
    return xss_test_script in str(response.content)


def xss_in_forms(form, url):
    xss_test_script = "<sCript>alert(1)</scriPt>"
    response = vuln_scan.submit_forms(form, xss_test_script, url)
    return xss_test_script in str(response.content)

def main():
    global url,vuln_scan
    url = input("Enter the url : ")
    vuln_scan = scanner.Scanner(url, [])
    vuln_scan.crawl()
    for link in vuln_scan.target_links:
        forms = vuln_scan.extract_forms(link)
        for form in forms:
            print("Testing form :" + link)
            is_vulnerable_to_xss =  vuln_scan.xss_in_forms(form, link)
            if is_vulnerable_to_xss:
                print("[+]XSS Discovered in " + link + " in the following form")
                print(form)
        if "=" in link:
            print("Testing get_request :" + link)
            is_vulnerable_to_xss = vuln_scan.xss_in_link(link)
            if is_vulnerable_to_xss:
                print("[-]XSS Discovered in" + link + "in the following form")
                print(form)
if __name__ == '__main__':
    main()
