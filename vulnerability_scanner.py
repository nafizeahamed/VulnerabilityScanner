from sql import SqlInjection
from xss import XSS
import authentication
import requests
import time
import scanner
import csrf
def main():
    target_url = input("Enter the url : ")
    vuln_scanner = scanner.Scanner(target_url, [])
    vuln_scanner.crawl()
    if not vuln_scanner.target_links:
        vuln_scanner.target_links.append(target_url)

    choice = int(input("*******Vulnerability Scanner****************\nEnter your choice :\n1.sql injection\n2.xss\n3.authentication\n4.csrf\n"))
    if choice == 1:
        print("*****************Sql Injection**********************")
        sql = SqlInjection()
        login = input("Do you want to check sql injection in login page :(yes/no)")
        if login == "yes":
            print("The Url of login page might be :")
            for link in vuln_scanner.target_links:
                login_list = ["login", "account", "Login"]
                for list in login_list:
                    if list in link:
                        print(link)
            login_url = input("Enter the url of login page :")
            sql.sql_in_login(login_url, vuln_scanner)
        else:
            start = time.time()
            sql.sql_in_whereclause(vuln_scanner)
            stop = time.time()
            print(f"Time taken to exploit sql injection was {stop - start} seconds")
    elif choice == 2:
        print("*****************Xss Vulnerabilityt**********************")
        xss = XSS()
        xss.run_xss(vuln_scanner)
    elif choice == 3:
        print("*****************Authentication Vulnerabilityt**********************")
        authentication.main()
    elif choice == 4:
        print("*****************CSRF Vulnerabilityt**********************")
        csrf.detect_csrf(target_url)
    else:
        print("Invalid Input!!!")
        main()


if __name__ == '__main__':
    main()
